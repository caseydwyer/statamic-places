(()=>{"use strict";const e=function(e,t,l,a,c,s,n,i){var o,d="function"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=l,d._compiled=!0),a&&(d.functional=!0),s&&(d._scopeId="data-v-"+s),n?(o=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),c&&c.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(n)},d._ssrRegister=o):c&&(o=i?function(){c.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:c),o)if(d.functional){d._injectStyles=o;var r=d.render;d.render=function(e,t){return o.call(t),r(e,t)}}else{var p=d.beforeCreate;d.beforeCreate=p?[].concat(p,o):[o]}return{exports:e,options:d}}({name:"PlacesSearch",mixins:[Fieldtype],props:{placeholder:{type:String,default:"Search..."},value:{type:Object,default:function(){return{}}}},data:function(){return{placeSelected:!1,placesSearch:null,selectedPlace:{}}},mounted:function(){this.initSelectedPlace(),this.initPlacesSearch()},computed:{fieldId:function(){return"statamic-places-"+this._uid},replicatorPreview:function(){if(!this.value)return"";var e=this.value.line_1+", "+this.value.city+", "+this.value.state;return this.value.line_1?e:""}},methods:{initPlacesSearch:function(){this.placesSearch=new google.maps.places.Autocomplete(document.getElementById(this.fieldId),{fields:["address_components","geometry","name","place_id","url"]}),this.placesSearch.addListener("place_changed",this.placeChanged)},initSelectedPlace:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.value&&!e?(this.placeSelected=!0,this.selectedPlace=this.value):(this.placeSelected=!1,this.selectedPlace={title:"",line_1:"",city:"",state:"",country:"",zipcode:"",lat:"",lon:"",google_place_id:"",google_url:""})},manuallyUpdated:function(){this.update(this.selectedPlace)},placeChanged:function(){var e=this.placesSearch.getPlace();0==e.length||e.length>1||(this.placeSelected=!0,this.parseSelectedPlace(e))},resetSelectedPlace:function(){this.initSelectedPlace(!0),this.update(this.selectedPlace)},parseSelectedPlace:function(e){var t=this;console.log(e);var l=e.address_components;_.each(l,(function(e){_.each(e.types,(function(l){switch(l){case"street_number":t.selectedPlace.line_1=e.long_name;break;case"route":t.selectedPlace.line_1+=" "+e.long_name;break;case"locality":t.selectedPlace.city=e.long_name;break;case"administrative_area_level_1":t.selectedPlace.state=e.short_name;break;case"country":t.selectedPlace.country=e.short_name;break;case"postal_code":t.selectedPlace.zipcode=e.long_name}}))})),this.selectedPlace.lat=e.geometry.location.lat(),this.selectedPlace.lon=e.geometry.location.lng(),this.selectedPlace.title=e.name,this.selectedPlace.google_place_id=e.place_id,this.selectedPlace.google_url=e.url,this.update(this.selectedPlace)}}},(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("div",{staticClass:"flex flex-wrap -mx-2"},[l("div",{staticClass:"flex flex-wrap items-center px-2 mb-3",class:e.placeSelected?"w-1/2":"w-full"},[l("label",{staticClass:"w-full"},[e._v("Title")]),e._v(" "),l("div",{staticClass:"flex-grow"},[l("text-input",{attrs:{id:e.fieldId,type:"text",placeholder:e.placeholder},model:{value:e.selectedPlace.title,callback:function(t){e.$set(e.selectedPlace,"title",t)},expression:"selectedPlace.title"}})],1),e._v(" "),l("div",{staticClass:"flex text-red ml-2 mr-1 opacity-50 hover:opacity-100 cursor-pointer",on:{click:e.resetSelectedPlace}},[l("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"19",viewBox:"0 0 18 19"}},[l("g",{attrs:{fill:"none","fill-rule":"evenodd",stroke:"currentColor","stroke-width":"2",transform:"translate(1 1.545)"}},[l("path",{attrs:{d:"M16 0L.160533333 15.8389333M16 15.8389333L.160533333 0"}})])])])]),e._v(" "),l("div",{staticClass:"px-2 mb-3",class:e.placeSelected?"w-1/2":"hidden"},[l("label",[e._v("Address Line 1")]),e._v(" "),l("text-input",{attrs:{type:"text",placeholder:"123 Cherry Lane"},on:{input:e.manuallyUpdated},model:{value:e.selectedPlace.line_1,callback:function(t){e.$set(e.selectedPlace,"line_1",t)},expression:"selectedPlace.line_1"}})],1)]),e._v(" "),e.placeSelected&&e.config.expand_on_select?l("div",{staticClass:"flex flex-wrap -mx-2"},[l("div",{staticClass:"w-1/2 md:w-1/4 px-2 mb-3"},[l("label",[e._v("City")]),e._v(" "),l("text-input",{attrs:{type:"text",placeholder:"Kansas City"},on:{input:e.manuallyUpdated},model:{value:e.selectedPlace.city,callback:function(t){e.$set(e.selectedPlace,"city",t)},expression:"selectedPlace.city"}})],1),e._v(" "),l("div",{staticClass:"w-1/2 md:w-1/4 px-2 mb-3"},[l("label",[e._v("State")]),e._v(" "),l("text-input",{attrs:{type:"text",placeholder:"MO"},on:{input:e.manuallyUpdated},model:{value:e.selectedPlace.state,callback:function(t){e.$set(e.selectedPlace,"state",t)},expression:"selectedPlace.state"}})],1),e._v(" "),l("div",{staticClass:"w-1/2 md:w-1/4 px-2 mb-3"},[l("label",[e._v("Zipcode")]),e._v(" "),l("text-input",{attrs:{type:"tel",placeholder:"64102"},on:{input:e.manuallyUpdated},model:{value:e.selectedPlace.zipcode,callback:function(t){e.$set(e.selectedPlace,"zipcode",t)},expression:"selectedPlace.zipcode"}})],1),e._v(" "),l("div",{staticClass:"w-1/2 md:w-1/4 px-2 mb-3"},[l("label",[e._v("Country")]),e._v(" "),l("text-input",{attrs:{type:"text",placeholder:"USA"},on:{input:e.manuallyUpdated},model:{value:e.selectedPlace.country,callback:function(t){e.$set(e.selectedPlace,"country",t)},expression:"selectedPlace.country"}})],1),e._v(" "),l("div",{staticClass:"w-1/4 px-2 mb-3"},[l("label",[e._v("Lat")]),e._v(" "),l("text-input",{attrs:{type:"tel",placeholder:"39.0889824"},on:{input:e.manuallyUpdated},model:{value:e.selectedPlace.lat,callback:function(t){e.$set(e.selectedPlace,"lat",t)},expression:"selectedPlace.lat"}})],1),e._v(" "),l("div",{staticClass:"w-1/4 px-2 mb-3"},[l("label",[e._v("Lon")]),e._v(" "),l("text-input",{attrs:{type:"tel",placeholder:"-94.6068529"},on:{input:e.manuallyUpdated},model:{value:e.selectedPlace.lon,callback:function(t){e.$set(e.selectedPlace,"lon",t)},expression:"selectedPlace.lon"}})],1),e._v(" "),l("div",{staticClass:"w-1/2 px-2 mb-3"},[l("label",[e._v("Maps URL")]),e._v(" "),l("text-input",{attrs:{type:"url",placeholder:"https://google.com/maps/12345"},on:{input:e.manuallyUpdated},model:{value:e.selectedPlace.google_url,callback:function(t){e.$set(e.selectedPlace,"google_url",t)},expression:"selectedPlace.google_url"}})],1)]):e._e()])}),[],!1,null,null,null).exports;Statamic.booting((function(){Statamic.$components.register("places_search-fieldtype",e)}))})();